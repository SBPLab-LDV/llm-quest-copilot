**音訊 Prompt 瘦身方案（低複雜度）**

更新：2025-10-15
狀態：已套用（模板與規則字串精簡），待回歸測試

—

目的
- 降低提示冗長與分歧，聚焦於「意圖直述＋請求評估」的通用框架。
- 保留安全一致性（限制僅約束動作/處置，意圖表達不受限）。

主要改動
- 刪除模板中的「醫療情境下具體需求推測指南」六類清單（避免誘發泛用句）。
- 簡化【重要原則】：
  - 意圖拆解與順序（逗號/頓號分詞 → 多意圖逐一對齊）。
  - 兩段式表達（直述＋請求評估；槽位不足至少直述）。
  - 限制一致（動作/處置受限；意圖直述/請求評估不受限；衝突則改為請求評估/如何安全地…）。
  - 用語與句式（口語化、單句、繁中；不得以無關泛用句取代對意圖的回應）。
  - 等價詞提示（簡版通用詞彙）。
- 規則字串（build_audio_template_rules）改為短版：
  - 僅保留輸出形狀、關鍵詞保全、多意圖逐一對齊、限制一致改寫三條。

變更檔案
- prompts/templates/audio_disfluency_template.yaml
- src/core/audio/context_utils.py: build_audio_template_rules

預期影響
- Token 降低，生成更聚焦於 original 的意圖，泛用安撫句佔槽下降。
- 在限制存在時，不消滅意圖，改以「請求評估/如何安全地…」表達。

回歸測試（建議）
- 用例（各 3 次）：
  - 口很乾，想喝水
  - 很痛，想換藥
  - 想走動，會頭暈
  - 嗆到，想回家
- 驗證點：
  - 前若干句是否逐意圖對齊（直述＋/或請求評估）。
  - 無與意圖無關的泛用句占據前幾槽；若出現，是否同句對應意圖。
  - 若限制存在，動作是否改寫為請求評估/如何安全地…。

後續選項（A/B）
- config.yaml: audio.use_context: false（A/B 測試，降低歷史噪音）。
- 視結果調整等價詞清單（保持簡短）。

